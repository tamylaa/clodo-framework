# Clodo Framework Service Manifest

## üìã **Overview**

Every service created with the CLODO Framework includes a comprehensive `service-manifest.json` file that captures the complete history and configuration of that service. This manifest serves as the single source of truth for:

- **Service History**: Complete audit trail of what went into creating the service
- **Service Consumption**: All information needed for other tools/services to interact with it
- **Service Rectification**: Troubleshooting and fixing issues
- **Reproducibility**: Recreating or redeploying the service with identical configuration

## üìÅ **File Location**

The service manifest is automatically created in:
```
{service-directory}/service-manifest.json
```

Example: `./services/user-service/service-manifest.json`

## üèóÔ∏è **Manifest Structure**

### **Metadata Section**
```json
{
  "metadata": {
    "serviceId": "unique-uuid",
    "createdAt": "2025-10-08T10:30:00Z",
    "createdBy": "CLODO Framework v2.0.0",
    "creationMethod": "three-phase-collection",
    "frameworkVersion": "2.0.0"
  }
}
```

### **Core Inputs Section**
The 6 absolutely required inputs provided by the user:
```json
{
  "coreInputs": {
    "inputs": {
      "service-name": "user-service",
      "environment": "development",
      "domain-name": "mycompany.com",
      "service-type": "api",
      "customer-name": null,
      "cloudflare-api-token": null
    }
  }
}
```

### **User Confirmable Inputs Section**
The 15 inputs that were auto-generated and user-confirmed/customized:
```json
{
  "userConfirmableInputs": {
    "customizations": 3,
    "acceptances": 12,
    "inputs": {
      "display-name": "User Service",
      "production-url": "api.mycompany.com",
      // ... all 15 inputs
    }
  }
}
```

### **Auto Generated Inputs Section**
The 67 inputs that were automatically generated:
```json
{
  "autoGeneratedInputs": {
    "categories": {
      "fileDiscovery": { /* 8 inputs */ },
      "apiResolution": { /* 12 inputs */ },
      "conventionBased": { /* 28 inputs */ },
      "contextInference": { /* 19 inputs including service manifest */ }
    }
  }
}
```

### **Service Configuration Section**
The final computed configuration used to create the service:
```json
{
  "serviceConfiguration": {
    "config": {
      "service": { /* complete service config */ },
      "networking": { /* networking config */ },
      "infrastructure": { /* infrastructure config */ },
      "deployment": { /* deployment config */ }
    }
  }
}
```

## üîç **Service Consumption**

### **For Other Services/Tools**
Use the manifest to understand how to interact with the service:

```javascript
const manifest = require('./service-manifest.json');

// Get API information
const apiUrl = manifest.consumption.api.baseUrl;
const healthCheck = manifest.consumption.api.healthCheck;

// Get environment variables needed
const requiredEnvVars = manifest.consumption.environmentVariables;

// Get dependency information
const runtimeDeps = manifest.consumption.dependencies.runtime;
```

### **For CI/CD Pipelines**
```yaml
# Use manifest for deployment configuration
- name: Deploy Service
  run: |
    MANIFEST=$(cat service-manifest.json)
    ENV=$(echo $MANIFEST | jq -r '.coreInputs.inputs.environment')
    URL=$(echo $MANIFEST | jq -r '.serviceConfiguration.config.networking.urls.production')
    echo "Deploying $ENV environment to $URL"
```

### **For Monitoring Systems**
```javascript
// Auto-configure monitoring based on manifest
const monitoring = manifest.serviceConfiguration.config.infrastructure.monitoring;
const healthEndpoints = manifest.consumption.api.healthCheck;
```

## üõ†Ô∏è **Service Rectification**

### **Troubleshooting Issues**
```javascript
const manifest = require('./service-manifest.json');

// Check what went wrong during creation
const auditTrail = manifest.auditTrail.entries;
const validation = manifest.validation;

// Get troubleshooting information
const commonIssues = manifest.rectification.troubleshooting.commonIssues;
const logs = manifest.rectification.troubleshooting.logs;
```

### **Recreating a Service**
```bash
# Use the manifest to recreate the service
clodo recreate user-service --from-manifest ./service-manifest.json
```

### **Fixing Configuration Issues**
```javascript
// Check what configuration was actually applied
const actualConfig = manifest.serviceConfiguration.config;

// Compare with expected configuration
const expectedConfig = generateExpectedConfig(manifest.coreInputs.inputs);

// Identify discrepancies
const issues = compareConfigurations(actualConfig, expectedConfig);
```

## üìä **Audit Trail**

The manifest maintains a complete history:

```json
{
  "auditTrail": {
    "entries": [
      {
        "timestamp": "2025-10-08T10:25:00Z",
        "action": "core-inputs-collected",
        "actor": "user",
        "details": "Collected 6 core inputs via interactive prompts"
      },
      {
        "timestamp": "2025-10-08T10:27:00Z",
        "action": "inputs-confirmed",
        "actor": "user",
        "details": "User confirmed 12 defaults and customized 3 inputs"
      },
      {
        "timestamp": "2025-10-08T10:28:00Z",
        "action": "service-generated",
        "actor": "CLODO Framework",
        "details": "Successfully generated service with 67 auto-generated configurations"
      }
    ]
  }
}
```

## üîó **Relationships & Dependencies**

### **Service Dependencies**
```json
{
  "relationships": {
    "dependsOn": ["auth-service", "database-service"],
    "usedBy": ["web-app", "mobile-app"],
    "shares": {
      "database": "shared-user-db",
      "domain": "mycompany.com"
    }
  }
}
```

### **Environment Dependencies**
```json
{
  "consumption": {
    "environmentVariables": [
      "DEV_DATABASE_URL",
      "DEV_REDIS_URL",
      "DEV_JWT_SECRET"
    ],
    "dependencies": {
      "runtime": ["@cloudflare/workers-types", "hono"],
      "development": ["jest", "@types/jest"]
    }
  }
}
```

## üß™ **Validation & Health Checks**

### **Service Validation**
```json
{
  "validation": {
    "overallStatus": "passed",
    "checks": {
      "configuration": "passed",
      "dependencies": "passed",
      "build": "passed",
      "tests": "passed",
      "deployment": "ready"
    }
  }
}
```

### **Health Monitoring**
```javascript
// Use manifest for health checks
const healthEndpoints = manifest.consumption.api.healthCheck;
const monitoringConfig = manifest.serviceConfiguration.config.infrastructure.monitoring;
```

## üìù **Best Practices**

### **For Service Developers**
1. **Always commit the service manifest** with your service code
2. **Use the manifest for documentation** - it's self-documenting
3. **Reference the manifest in READMEs** for consumption instructions

### **For Platform Teams**
1. **Index service manifests** in a central registry
2. **Use manifests for dependency management** across services
3. **Monitor manifest changes** for configuration drift detection

### **For DevOps Teams**
1. **Automate deployment using manifest data**
2. **Use manifests for environment consistency checks**
3. **Generate monitoring dashboards** from manifest information

## üîÑ **Manifest Lifecycle**

1. **Creation**: Generated during the three-phase service creation process
2. **Updates**: Modified when service configuration changes
3. **Consumption**: Read by other services, tools, and deployment systems
4. **Archival**: Retained for historical reference and troubleshooting

## üìã **Example Usage Scenarios**

### **API Client Generation**
```javascript
// Generate API client from manifest
const apiSpec = manifest.consumption.api.openapiSpec;
const baseUrl = manifest.consumption.api.baseUrl;
generateApiClient(apiSpec, baseUrl);
```

### **Infrastructure as Code**
```javascript
// Generate Terraform/IaC from manifest
const infra = manifest.serviceConfiguration.config.infrastructure;
generateTerraformConfig(infra);
```

### **Documentation Generation**
```javascript
// Generate API documentation from manifest
const service = manifest.serviceConfiguration.config.service;
const api = manifest.consumption.api;
generateApiDocs(service, api);
```

---

The service manifest transforms each CLODO Framework service into a **self-documenting, self-healing, and self-integrating** component that can be easily consumed, monitored, and maintained throughout its lifecycle.